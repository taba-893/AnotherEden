<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ねこにっき 検索</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  input { font-size:16px; }
  table { width: 80%; border-collapse: collapse; margin-bottom: 30px; margin:0 auto; table-layout: fixed;}
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  .hidden { display: none; }
.search-container {
  text-align: center; /* 中央寄せ */
  margin: 20px 0; /* 上下に余白 */
}

.search-container input {
  display: inline-block; /* 横並び */
  margin: 5px;
  padding: 8px;
  width: 250px; /* 横幅を揃える */
  font-size: 16px;
}
</style>
<link rel="stylesheet" href="nekonikki.css">
</head>
<body>

<h1>検索　（最終更新日：2025年10月11日）</h1>
<div class="search-container">
  <input type="text" id="searchInput1" placeholder="フレーズで検索">
  <input type="text" id="searchInput2" placeholder="場所で検索">
  <input type="text" id="searchInput3" placeholder="時代で検索">
</div>

<h2>ねこにっき　検索</h2>
<table class="search-table" data-char-col="2">
  <thead>
    <tr><th>フレーズ</th><th>場所</th><th>時代</th><th>マップ</th></tr>
  </thead>
  <tbody>
    <tr><td>たくさんのヒトの熱狂が伝わってくる……<p>賑やかなスタジアムニャマス！</p></td><td>サテラ・スタジアム</td><td>未来・ガルレア大陸</td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td>この里　寒すぎるニャマス！　はやく<p>かまくらの中に避難するニャマス！</p></td><td>隠れ里　イトイス</td><td>現代・ガルレア大陸</td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td>早く連れ戻すニャマス！　生きている者が<p>いるべき世界じゃないニャマス！</p></td><td>煉獄界</td><td>古代・ミグレイナ大陸</td><td><img src="" class="map-img" alt=""></td></tr></td></tr>
    <tr><td>湖の上に街が……！　小舟に揺られて<p>優雅に　まわってみたいニャマスね。</p></td><td>水の都　アクトゥール</td><td>古代・ミグレイナ大陸</td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td>山風が涼しくて<p>風車の音が　心地いい国ニャマス～。</p></td><td>山の国　ガダロ</td><td>古代・ガルレア大陸</td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td>ワタクシたち猫にとって<p>居心地がよさそうな社ニャマスね……！</p></td><td>猫神神社</td><td>現代・ガルレア大陸</td><td><img src="猫神神社.PNG" class="map-img" alt="猫神神社"></td></tr>
    <tr><td>木の上に大きなヒトたちがいっぱい……<p>スケールの大きな村ニャマス。</p></td><td>古代樹の村　パドレ</td><td>古代・ガルレア大陸</td><td><img src="古代樹の村　パドレ.PNG" class="map-img" alt="パドレ"></td></tr>
    <tr><td>ベンチに座って　空中から街を<p>一望できるなんて……！　すごい技術ニャマス！</p></td><td>空中遊郭　イージア</td><td>未来・ガルレア大陸</td><td><img src="空中遊郭　イージア.PNG" class="map-img" alt="イージア"></td></tr>
    <tr><td>見晴らしがいい街ニャマスね。空に<p>浮かんだ大きな木が　よく見えるニャマス。</p></td><td>浮遊街　ニルヴァ</td><td>未来・ミグレイナ大陸</td><td><img src="浮遊街　ニルヴァ.PNG" class="map-img" alt="ニルヴァ"></td></tr>
    <tr><td>綺麗な黄金色の麦畑ニャマス！<p>かくれんぼしたら　楽しそうニャマスね。</p></td><td>ラウラ・ドーム</td><td>未来・ミグレイナ大陸</td><td><img src="ラウラ・ドーム.PNG" class="map-img" alt="ラウラ・ドーム"></td></tr>
    <tr><td>色鮮やかな国ニャマス！<p>猫ちゃんのレースも　興味深いニャマスね！</p></td><td>辰の国　ナグシャム</td><td>現代・ガルレア大陸</td><td><img src="辰の国　ナグシャム.PNG" class="map-img" alt="ナグシャム"></td></tr>
    <tr><td>最先端の都市ニャマスね！　根時代では<p>どんな物が売っているんニャマス？</p></td><td>曙光都市エルジオン</td><td>未来・ミグレイナ大陸</td><td><img src="曙光都市エルジオン.PNG" class="map-img" alt="エルジオン"></td></tr>
    <tr><td>素敵なお城が　こんな姿に……<p>争いとは　愚かニャマスね……</p></td><td>ミグランス城</td><td>現在・ミグレイナ大陸</td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td>穏やかで　美しい海岸……<p>世界の果てに　ふさわしい場所ニャマスね！</p></td><td>最果ての島</td><td>未来・ミグレイナ大陸</td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>
    <tr><td><p></p></td><td></td><td></td><td><img src="" class="map-img" alt=""></td></tr>

    <script>
const searchInput1 = document.getElementById("searchInput1"); // 書・異節・改典・典録
const searchInput2 = document.getElementById("searchInput2"); // キャラ名
const searchInput3 = document.getElementById("searchInput3"); // 入手場所（追加）
const tables = document.querySelectorAll("table.search-table");
const rows = document.querySelectorAll("table.search-table tbody tr");

function toHiragana(str) {
  return str.replace(/[\u30a1-\u30f6]/g, ch =>
    String.fromCharCode(ch.charCodeAt(0) - 0x60)
  );
}

function filterRows() {
  const keyword1 = toHiragana((searchInput1?.value || "").trim().toLowerCase());
  const keyword2 = toHiragana((searchInput2?.value || "").trim().toLowerCase());
  const keyword3 = toHiragana((searchInput3?.value || "").trim().toLowerCase()); // 入手場所
  let matchFound = false;

  rows.forEach(row => {
    const table = row.closest("table");
    const charColIndex = parseInt(table.dataset.charCol) - 1; // 0-based index
    const cells = row.querySelectorAll("td");

    // 列テキスト取得（安全に）
    const col1Text  = toHiragana((cells[0]?.innerText || "").toLowerCase());                 // 書/異節/改典/典録
    const charText  = toHiragana((cells[charColIndex]?.innerText || "").toLowerCase());      // キャラ名
    const hasPlace  = cells.length >= 3;                                                      // 入手場所列の有無
    const placeText = hasPlace ? toHiragana((cells[2].innerText || "").toLowerCase()) : "";   // 入手場所（ノーマルのみ）

    // AND 条件（キーワード未入力はスルー）
    const match1 = !keyword1 || col1Text.includes(keyword1);
    const match2 = !keyword2 || charText.includes(keyword2);
    const match3 = !keyword3 || (hasPlace && placeText.includes(keyword3));

    if (match1 && match2 && match3) {
      row.classList.remove("hidden");
      matchFound = true;
    } else {
      row.classList.add("hidden");
    }
  });

  // メッセージ表示
  const noResult = document.getElementById("noResult");
  const h2Element = document.querySelector("h2");
  if (!matchFound && (keyword1 || keyword2 || keyword3)) {
    if (!noResult) {
      const msg = document.createElement("p");
      msg.id = "noResult";
      msg.style.color = "red";
      msg.innerText = "該当データはありません";
      if (h2Element) {
        h2Element.parentNode.insertBefore(msg, h2Element);
      } else {
        document.body.appendChild(msg);
      }
    }
  } else {
    if (noResult) noResult.remove();
  }
}

// 入力イベント
searchInput1.addEventListener("keyup", filterRows);
searchInput2.addEventListener("keyup", filterRows);
searchInput3.addEventListener("keyup", filterRows); // 追加

(function(){
// オーバーレイ生成（ページに1個）
const overlay = document.createElement('div');
overlay.className = 'lightbox-overlay';
overlay.innerHTML = '<span class="lightbox-close" aria-label="閉じる">×</span><img alt="preview">';
document.body.appendChild(overlay);
const big = overlay.querySelector('img');
const closeBtn = overlay.querySelector('.lightbox-close');


function open(src){ big.src = src; overlay.classList.add('is-open'); document.body.style.overflow='hidden'; }
function close(){ overlay.classList.remove('is-open'); big.src = ''; document.body.style.overflow=''; }


// ▼ 全画像を対象（表だけに限定したい場合は 'document' → '.search-table' に変更）
document.addEventListener('click', function(e){
const img = e.target.closest('img');
if (!img) return;
const full = img.getAttribute('data-full') || img.src; // data-full優先
open(full);
});


overlay.addEventListener('click', (e)=>{ if (e.target===overlay || e.target===closeBtn) close(); });
document.addEventListener('keydown', (e)=>{ if (e.key==='Escape') close(); });
})();
</script>




</body>
</html>